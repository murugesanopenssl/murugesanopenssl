<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spending Tracker - Firebase Connected</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  button { margin: 5px; padding: 10px; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #999; padding: 8px; text-align: left; }
  th { background-color: #eee; }
</style>
</head>
<body>

<h2>Spending Tracker (Firebase Connected)</h2>
<p>All data below is stored in Firebase Realtime Database.</p>

<button onclick="saveToDB()">ðŸ’¾ Save to Firebase</button>
<button onclick="loadFromDB()">ðŸ”„ Load from Firebase</button>

<div id="dbTable"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  // ðŸ”§ Your Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDSNanmji7WVBtQHlPO-J_E5RQu9Qlq4Qw",
    authDomain: "openmurugesan.firebaseapp.com",
    projectId: "openmurugesan",
    storageBucket: "openmurugesan.firebasestorage.app",
    messagingSenderId: "307675598593",
    appId: "1:307675598593:web:4af163460ce2c3bc719500",
    measurementId: "G-0MFK92PQMP",
    databaseURL: "https://openmurugesan-default-rtdb.asia-southeast1.firebasedatabase.app/"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Example spending data (from your JS array)
  function formatDate(d) { return d; }
  const spendingData = {
    Nov: [
      [ formatDate("04-Nov-2025"), "Dinner",440.00,       "",   0.00 ],
      [ formatDate("03-Nov-2025"), "Snacks", 30.00, "Petrol", 210.00 ],
      [ formatDate("02-Nov-2025"), "Rice", 700.00, "BananaLeaf", 10.00, "Veg", 70.00 ],
      [ formatDate("01-Nov-2025"), "ToBng", 69.00, "Veg", 107.00, "Rice", 360.00, "Lunch", 55.00, "Snacks", 30.00 ]
    ]
  };

  // ðŸ’¾ Save array to Firebase
  async function saveToDB() {
    const spendingRef = ref(db, "spendingData");
    await set(spendingRef, spendingData);
    alert("âœ… Spending data saved to Firebase!");
  }

  // ðŸ”„ Load data from Firebase
  async function loadFromDB() {
    const snapshot = await get(child(ref(db), "spendingData"));
    if (snapshot.exists()) {
      const data = snapshot.val();
      const rows = data.Nov;
      let html = "<table><tr><th>Date</th><th>Item</th><th>Amount</th></tr>";

      rows.forEach(row => {
        const date = row[0];
        for (let i = 1; i < row.length; i += 2) {
          const item = row[i];
          const amt = row[i + 1];
          if (item && amt > 0) {
            html += `<tr><td>${date}</td><td>${item}</td><td>${amt}</td></tr>`;
          }
        }
      });

      html += "</table>";
      document.getElementById("dbTable").innerHTML = html;
    } else {
      document.getElementById("dbTable").innerHTML = "<p>No data found in Firebase.</p>";
    }
  }

  // Auto-load when page opens
  window.addEventListener("load", loadFromDB);
</script>

</body>
</html>